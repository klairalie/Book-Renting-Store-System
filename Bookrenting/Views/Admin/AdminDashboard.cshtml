@using Microsoft.EntityFrameworkCore.Metadata.Internal
@{
    ViewData["Title"] = "Admin Dashboard";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}


<!-- Dashboard Cards -->
<div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6">
    <!-- Total Books -->
   <div class="bg-white p-6 rounded-lg shadow hover:shadow-lg transition">
    <h3 class="text-lg font-semibold text-gray-700">Total Books</h3>
    <p class="mt-2 text-3xl font-bold text-gray-900">@ViewBag.TotalBooks</p>
    <p class="text-gray-500 mt-1">All books available in the store</p>
</div>


    <!-- Total Users -->
    <div class="bg-white p-6 rounded-lg shadow hover:shadow-lg transition">
        <h3 class="text-lg font-semibold text-gray-700">Total Users</h3>
        <p class="mt-2 text-3xl font-bold text-gray-900">@ViewBag.TotalUsers</p>
        <p class="text-gray-500 mt-1">All registered users</p>
    </div>

    <!-- Pending Rentals -->
    <div class="bg-white p-6 rounded-lg shadow hover:shadow-lg transition">
        <h3 class="text-lg font-semibold text-gray-700">Pending Rentals</h3>
        <p class="mt-2 text-3xl font-bold text-gray-900"></p>
        <p class="text-gray-500 mt-1">Books waiting for approval</p>
    </div>
</div>

<div class="mt-10 bg-white p-6 rounded-xl shadow border border-[#e8e5d9]">

    <h2 class="text-xl font-bold text-[#4b3832] mb-4">Activity Chart</h2>
    <p class="text-gray-600 mb-6">
        Daily rented books and total sales for the current month.
    </p>

    <!-- Summary Cards -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
        <div class="bg-[#f8f4ef] p-6 rounded-xl shadow text-center">
            <h3 class="text-lg font-semibold text-[#4b3832]">Books Rented Today</h3>
            <p class="text-3xl font-bold text-[#a47148] mt-2">@ViewBag.DailyRentCount</p>
        </div>

        <div class="bg-[#f8f4ef] p-6 rounded-xl shadow text-center">
            <h3 class="text-lg font-semibold text-[#4b3832]">Total Sales This Month</h3>
            <p class="text-3xl font-bold text-[#a47148] mt-2">â‚±@ViewBag.MonthlySales</p>
        </div>
    </div>

    <!-- Chart -->
    <canvas id="activityChart" height="120"></canvas>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    const chartData = @Html.Raw(System.Text.Json.JsonSerializer.Serialize(ViewBag.ChartData));

    const labels = chartData.map(x => "Day " + x.Day);
    const rentCounts = chartData.map(x => x.Count);
    const salesTotals = chartData.map(x => x.Total);

    const ctx = document.getElementById("activityChart").getContext("2d");

    new Chart(ctx, {
        type: "line",
        data: {
            labels: labels,
            datasets: [
                {
                    label: "Books Rented",
                    data: rentCounts,
                    borderWidth: 3,
                    borderColor: "#a47148",
                    backgroundColor: "#a47148",
                    fill: false,
                    tension: 0.5,          // ðŸ”¥ Smooth curves
                    pointRadius: 4,
                    pointHoverRadius: 7
                },
                {
                    label: "Total Sales (â‚±)",
                    data: salesTotals,
                    borderWidth: 3,
                    borderColor: "#4b3832",
                    backgroundColor: "#4b3832",
                    fill: false,
                    tension: 0.5,          // ðŸ”¥ Smooth curves
                    pointRadius: 4,
                    pointHoverRadius: 7
                }
            ]
        },
        options: {
            responsive: true,
            plugins: {
                legend: { position: "top" }
            },
            scales: {
                y: { beginAtZero: true }
            }
        }
    });
</script>
